---
---
<dialog id="delete-mat-modal" class="modal-fixed rounded-3xl p-0 border-2 border-red-100 shadow-2xl w-full max-w-md outline-none overflow-hidden">
    <div class="bg-white p-8 text-center">
        <div class="w-20 h-20 bg-red-50 text-red-500 rounded-3xl flex items-center justify-center text-4xl mx-auto mb-6 shadow-sm border border-red-100">
            ğŸ—‘ï¸
        </div>
        
        <h2 class="text-2xl font-black text-brand-deep uppercase tracking-tight mb-2">Â¿Eliminar Unidad?</h2>
        <p class="text-brand-dark/60 text-sm font-medium mb-8 leading-relaxed">
            Vas a eliminar la matrÃ­cula <span id="delete-mat-display" class="font-black text-red-600 px-2 py-0.5 bg-red-50 rounded border border-red-100"></span>. <br/>Los datos asociados podrÃ­an quedar huÃ©rfanos.
        </p>

        <div class="flex gap-3">
            <button onclick="this.closest('dialog').close()" class="flex-1 px-6 py-4 rounded-2xl font-bold text-brand-dark hover:bg-gray-100 transition-colors uppercase text-[10px] tracking-widest border border-transparent">
                Cancelar
            </button>
            <button id="confirm-delete-mat" class="flex-1 px-6 py-4 rounded-2xl bg-red-500 text-white font-black hover:bg-red-600 transition-all shadow-lg shadow-red-200 uppercase text-[10px] tracking-widest">
                Confirmar Baja
            </button>
        </div>
    </div>
</dialog>

<script>
    import { actions } from 'astro:actions';
    let currentId: number | null = null;

    // Escuchamos el evento para abrir el modal
    window.addEventListener('open-delete-mat-modal', (e: any) => {
        currentId = e.detail.id;
        document.getElementById('delete-mat-display')!.innerText = e.detail.numero;
        (document.getElementById('delete-mat-modal') as HTMLDialogElement).showModal();
    });

    document.getElementById('confirm-delete-mat')?.addEventListener('click', async () => {
        if (!currentId) return;
        const { error } = await actions.deleteMatricula({ id: currentId });
        if (error) alert(error.message);
        else window.location.reload();
    });
</script>